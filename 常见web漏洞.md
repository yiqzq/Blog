# 常见web漏洞

[toc]

## 1 明文传输登录口令

**漏洞描述**
用户登录过程中使用明文传输用户登录信息，若用户遭受中间人攻击时，攻击者可直接获取 该用户登录账户，从而进行进一步渗透。

**解决方案**

1. 密码加密传输
2. 使用HTTPS协议



## 2 暴力破解

**漏洞描述**
由于没有对登录页面进行相关的防暴力破解机制，如无验证码、有验证码但验证码未在服务器端校验以及无登录错误次数限制等，导致攻击者可通过暴力破解获取用户登录账户及口令，从而获取网站登录访问权限！

**解决方案**

1. 添加验证码机制
2. 验证码校验放在服务端

## 3 SQL注入

**漏洞描述**
Web程序代码中对于用户提交的参数未做过滤就直接放到SQL语句中执行，导致参数中的特殊字符打破了SQL语句原有逻辑，黑客可以利用该漏洞执行任意SQL语句，如查询数据、下载数据、写入webshell、执行系统命令以及绕过登录限制等。

**解决方案**

1. SQL语句预编译以及绑定变量
2. 特殊字符转义操作
3. 规范数据长度
4. 避免SQL错误在客户端的显示

## 4 跨站脚本攻击(XSS)

**漏洞描述**

1、Web程序代码中把用户提交的参数未做过滤或过了不严就直接输出到页面，参数中的特殊字符打破了HTML页面的原有逻辑，黑客可以利用该漏洞执行恶意HTML/JS代码、构造蠕虫传播、篡改页面实施钓鱼攻击、诱以及导用户再次登录，然后获取其登录凭证等。
2、XSS攻击对Web服务器本身虽无直接危害，但是它借助网站进行传播，对网站用户进行攻击，窃取网站用户账号信息等，从而也会对网站产生较严重的危害。	

**解决方案**

1. 对用户输入的数据进行过滤和转义

## 5 任意文件上传

**漏洞描述**
文件上传漏洞通常由于网页代码中的文件上传路径变量过滤不严或webserver相关解析漏洞未修复而造成的，如果文件上传功能实现代码没有严格限制用户上传的文件后缀以及文件类型，攻击者可通过 Web 访问的目录上传任意文件，包括网站后门文件（webshell），进而远程控制网站服务器。
攻击者可通过此漏洞上传恶意脚本文件，对服务器的正常运行造成安全威胁！

**解决方案**

1. 对上传文件类型进行限制，并且不能只做前端的限制，而要前端和后端一起限制，后端可以进行扩展名检测，重命名文件，MIME类型检测以及限制上传文件的大小，或是将上传的文件放在安全的路径下，尽量放于webserver之外的远程服务器等。
2. 严格限制和校验上传的文件，禁止上传恶意代码的文件。同时限制相关目录的执行权限，防范webshell攻击。

## 6 未授权访问

**漏洞描述**
由于没有对相关敏感页面进行访问权限的检查，导致攻击者可未授权访问，从而获取敏感信息及进行未授权操作等！

**解决方案**

1. 对相关页面进行严格的访问权限的控制以及对访问角色进行权限检查！

## 7 越权访问

**漏洞描述**
由于没有对用户访问角色的权限进行严格的检查及限制，导致当前账号可对其他账号进行相关操作，如查看、修改等！

**解决方案**

1. 对用户访问角色的权限进行严格的检查及限制！

## 8 任意文件下载

**漏洞描述**
文件下载处由于未对下载路径进行过滤，利用路径回溯符../跳出程序本身的限制目录实现来下载任意文件，如下载系统密码文件等！

**解决方案**

1. 对下载路径进行过滤，如下载前对传入的参数进行过滤，并且对下载文件类型进行检查，是否是允许下载的类型，另外禁止使用回溯符../ ！

## 9 跨站请求伪造

**漏洞描述**

在某个恶意站点的页面上，促使访问者请求被攻击网站的某个 URL，从而达到改变服务器端数据的目的

**流程**

```
目标网站：www.webA.com
恶意网站：www.webB.com
转账功能链接：
http://www.webA.com/transport?account=abc&total=500
恶意网站www.webB.com某CSRF页面：
<script>
new Image().src=’http://www.webA.com/transport?account=abc&total=500’;
</script>
诱骗受害用户访问恶意网站CSRF页面
```

**解决方案**

1. 判断HTTP Referer

2. 图形验证码

3. 使用隐藏的tonkenhash做校验